# KEYWORDS

## SOP ( SAME ORIGIN POLICY )

[Same-origin policy (SOP) | Web Security Academy](https://portswigger.net/web-security/cors/same-origin-policy)

Web browser mechanic to prevent website attack each other 

→ restricts scripts on one origin from accessing data from another origin

→ contain: URI **protocols**/**scheme**, **hostname & port**

Sample: `http://normal-website.com/example/example.html`

![Untitled](KEYWORDS%2022e00ef59f0949fd862ca3c0dbcba934/Untitled.png)

Useful: prevent information pass through when browser send http request from site to site, impersonate → CSRF

relexed with cookie of subdomain of a site, mitigate by httponly

FQDN (fully qualified domain name) set through document.domain

Extra: 

[Know The Web: SOP (Same Origin Policy)](https://dev.to/souvikinator/know-the-web-sop-same-origin-policy-3cnc)

## ****CSRF****

[CSRF tokens | Web Security Academy](https://portswigger.net/web-security/csrf/tokens)

Characteristic: Unique, secret, unpredictable value generated by server-side application transmit to client through HTTP request, contain significant entropy and be strongly unpredictable.

Should use cryptographically secure pseudo-random number generator (CSPRNG), seeded with timestamp & static secret

Upgrade: individual tokens ← hashing with user-specific entropy + CSPRNG

Transmit CSRF token in hidden field in POST method, place  near non-hidden field & before user-controllable data, say no with cookie, url query string,… 

Token store in server side in user’s session data 

Browsers do not normally allow custom headers to be sent cross-domain → defense against predict or capture another user's token

Appendix:

SameSite cookies: [https://portswigger.net/web-security/csrf/samesite-cookies](https://portswigger.net/web-security/csrf/samesite-cookies)

- Strict
- Lax: Only GET req, user interact or click only.

XSS vs CSRF & to mitigate XSS with tokens: [https://portswigger.net/web-security/csrf/xss-vs-csrf](https://portswigger.net/web-security/csrf/xss-vs-csrf)

## Fetch method

[fetch() - Web APIs | MDN](https://developer.mozilla.org/en-US/docs/Web/API/Fetch)

## DOM

[Introduction to the DOM - Web APIs | MDN](https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model/Introduction)

[DOM-based vulnerabilities | Web Security Academy](https://portswigger.net/web-security/dom-based)

## Client-side template injection

Appendix:

[https://portswigger.net/research/xss-without-html-client-side-template-injection-with-angularjs](https://portswigger.net/research/xss-without-html-client-side-template-injection-with-angularjs)

[https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection)

## Server-side template injection

Appendix:

[https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection)

## **Out-of-band Application Security Testing**

## CSP ( CONTENT SECURITY POLICY )

[Content security policy | Web Security Academy](https://portswigger.net/web-security/cross-site-scripting/content-security-policy)

Security mechanic to mitigate XSS, … by restrict resources loaded or framed by other pages

Implement Content-Security-Policy in HTTP resp header

content delivery networks (CDNs) not be trusted

2 ways  to trusted resources: nonces (a random value) [2 ways compare] & hashes [1 way compare, update each time]

## Dangling Markup Injection:

[Dangling markup injection | Web Security Academy](https://portswigger.net/web-security/cross-site-scripting/dangling-markup)

capturing data cross-domain 

SAMPLE → not close tag → everything after is treated as part of URL → send to attacker server ← URL encoded 

Any attribute make external request can be compromised.

Mitigate: using CSP, filter … etc

![Untitled](KEYWORDS%2022e00ef59f0949fd862ca3c0dbcba934/Untitled%201.png)

### NOTE: <embed> vs <iframe>, why embed can not interact with DOM

[Difference between iframe, embed and object elements](https://stackoverflow.com/questions/16660559/difference-between-iframe-embed-and-object-elements)